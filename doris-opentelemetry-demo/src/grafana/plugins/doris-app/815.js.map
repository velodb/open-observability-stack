{"version":3,"file":"815.js?_cache=98566353430631706e1b","mappings":"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","sources":["webpack://doris-app/./utils/utils.ts","webpack://doris-app/./store/discover.ts","webpack://doris-app/./utils/data.ts","webpack://doris-app/./types/type.ts","webpack://doris-app/./services/metaservice.ts"],"sourcesContent":["// --- stable stringify: 递归排序键，避免循环引用导致崩溃 ---\nfunction stableStringify(value: any): string {\n    const seen = new WeakSet();\n\n    const recur = (v: any): string => {\n        if (v === null) {\n            return 'null';\n        }\n        const t = typeof v;\n        if (t === 'number') {\n            return Number.isFinite(v) ? String(v) : 'null';\n        }\n        if (t === 'boolean') {\n            return v ? 'true' : 'false';\n        }\n        if (t === 'string') {\n            return JSON.stringify(v);\n        }\n        if (t === 'bigint') {\n            return JSON.stringify(v.toString());\n        }\n        if (t === 'undefined' || t === 'function' || t === 'symbol') {\n            return 'null';\n        }\n\n        // object / array\n        if (seen.has(v)) {\n            return '\"[Circular]\"';\n        }\n        seen.add(v);\n\n        if (Array.isArray(v)) {\n            return '[' + v.map(recur).join(',') + ']';\n        }\n\n        const keys = Object.keys(v).sort();\n        const body = keys.map(k => JSON.stringify(k) + ':' + recur(v[k])).join(',');\n        return '{' + body + '}';\n    };\n\n    return recur(value);\n}\n\n// --- 小工具 ---\nfunction u8ToHex(u8: Uint8Array): string {\n    let out = '';\n    for (let i = 0; i < u8.length; i++) {\n        out += u8[i].toString(16).padStart(2, '0');\n    }\n    return out;\n}\n\nfunction hasSubtle(): boolean {\n    return typeof window !== 'undefined' && !!window.crypto && !!window.isSecureContext && typeof window.crypto.subtle?.digest === 'function';\n}\n\n// --- 纯 JS 的 SHA-256 fallback（简实现，无依赖） ---\nfunction sha256HexJS(data: Uint8Array): string {\n    // 常量\n    const K = new Uint32Array([\n        0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5, 0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe,\n        0x9bdc06a7, 0xc19bf174, 0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da, 0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7,\n        0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967, 0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85, 0xa2bfe8a1, 0xa81a664b,\n        0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070, 0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n        0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2,\n    ]);\n\n    // 初始哈希\n    let h0 = 0x6a09e667,\n        h1 = 0xbb67ae85,\n        h2 = 0x3c6ef372,\n        h3 = 0xa54ff53a,\n        h4 = 0x510e527f,\n        h5 = 0x9b05688c,\n        h6 = 0x1f83d9ab,\n        h7 = 0x5be0cd19;\n\n    // 预处理：填充\n    const l = data.length;\n    const bitLenHi = (l >>> 29) >>> 0;\n    const bitLenLo = (l << 3) >>> 0;\n    const nBlocks = (((l + 9) >> 6) + 1) << 4; // 以 16 个 32bit 为一组\n    const M = new Uint32Array(nBlocks);\n\n    for (let i = 0; i < l; i++) {\n        M[i >> 2] |= data[i] << ((3 - (i & 3)) << 3);\n    }\n    M[l >> 2] |= 0x80 << ((3 - (l & 3)) << 3);\n    M[nBlocks - 2] = bitLenHi;\n    M[nBlocks - 1] = bitLenLo;\n\n    const W = new Uint32Array(64);\n\n    const rotr = (x: number, n: number) => (x >>> n) | (x << (32 - n));\n    for (let i = 0; i < nBlocks; i += 16) {\n        for (let t = 0; t < 16; t++) {\n            W[t] = M[i + t];\n        }\n        for (let t = 16; t < 64; t++) {\n            const s0 = (rotr(W[t - 15], 7) ^ rotr(W[t - 15], 18) ^ (W[t - 15] >>> 3)) >>> 0;\n            const s1 = (rotr(W[t - 2], 17) ^ rotr(W[t - 2], 19) ^ (W[t - 2] >>> 10)) >>> 0;\n            W[t] = (W[t - 16] + s0 + W[t - 7] + s1) >>> 0;\n        }\n\n        let a = h0,\n            b = h1,\n            c = h2,\n            d = h3,\n            e = h4,\n            f = h5,\n            g = h6,\n            h = h7;\n\n        for (let t = 0; t < 64; t++) {\n            const S1 = (rotr(e, 6) ^ rotr(e, 11) ^ rotr(e, 25)) >>> 0;\n            const ch = ((e & f) ^ (~e & g)) >>> 0;\n            const T1 = (h + S1 + ch + K[t] + W[t]) >>> 0;\n            const S0 = (rotr(a, 2) ^ rotr(a, 13) ^ rotr(a, 22)) >>> 0;\n            const maj = ((a & b) ^ (a & c) ^ (b & c)) >>> 0;\n            const T2 = (S0 + maj) >>> 0;\n\n            h = g;\n            g = f;\n            f = e;\n            e = (d + T1) >>> 0;\n            d = c;\n            c = b;\n            b = a;\n            a = (T1 + T2) >>> 0;\n        }\n\n        h0 = (h0 + a) >>> 0;\n        h1 = (h1 + b) >>> 0;\n        h2 = (h2 + c) >>> 0;\n        h3 = (h3 + d) >>> 0;\n        h4 = (h4 + e) >>> 0;\n        h5 = (h5 + f) >>> 0;\n        h6 = (h6 + g) >>> 0;\n        h7 = (h7 + h) >>> 0;\n    }\n\n    const out = new Uint8Array(32);\n    const H = [h0, h1, h2, h3, h4, h5, h6, h7];\n    for (let i = 0; i < 8; i++) {\n        out[i * 4 + 0] = (H[i] >>> 24) & 0xff;\n        out[i * 4 + 1] = (H[i] >>> 16) & 0xff;\n        out[i * 4 + 2] = (H[i] >>> 8) & 0xff;\n        out[i * 4 + 3] = H[i] & 0xff;\n    }\n    return u8ToHex(out);\n}\n\n// --- 通用 SHA-256（浏览器优先，fallback 到纯 JS） ---\nasync function sha256Hex(input: string): Promise<string> {\n    const data = new TextEncoder().encode(input);\n    if (hasSubtle()) {\n        const buf = await window.crypto.subtle.digest('SHA-256', data);\n        return u8ToHex(new Uint8Array(buf));\n    }\n    // 非 https 或老环境：走纯 JS\n    return sha256HexJS(data);\n}\n\n// --- 你的两个导出函数 ---\nexport async function generateUid(obj: any) {\n    const json = stableStringify(obj);\n    return sha256Hex(json);\n}\n\nexport async function generateTableDataUID(items: any[]) {\n    // 允许 _original 缺失时退回整个 item；并发计算，更快\n    const sources = items.map(it => (it && it._original) ?? it);\n    const uids = await Promise.all(sources.map(generateUid));\n    return items.map((it, i) => ({ ...it, _uid: uids[i] }));\n}\n\n\nexport function isIgnorableHighlightToken(token: string): boolean {\n    const ignoreChars = new Set([\n        ',',\n        '.',\n        ';',\n        ':',\n        '(',\n        ')',\n        '{',\n        '}',\n        '[',\n        ']',\n        '+',\n        '-',\n        '*',\n        '/',\n        '=',\n        '<',\n        '>',\n        '!',\n        '?',\n        '|',\n        '&',\n        '%',\n        '^',\n        '$',\n        '#',\n        '@',\n        '~',\n        '`',\n        '\\\\',\n        \"'\",\n        '\"',\n    ]);\n    // 全是空格或换行\n    if (!token.trim()) {return true;}\n    // 单个字符且在 ignoreChars 中\n    if (token.length === 1 && ignoreChars.has(token)) {return true;}\n    // 多个字符但全是标点符号\n    if (/^[\\u2000-\\u206F\\u2E00-\\u2E7F!\"#$%&'()*+,\\-./:;<=>?@[\\\\\\]^_`{|}~]+$/.test(token)) {\n        return true;\n    }\n\n    return false;\n}\n\nexport function trimSpacesAroundEquals(str: string) {\n  // 去掉等于号两边所有空格\n  return str.replace(/\\s*=\\s*/g, '=');\n}\n\n","import { atom } from 'jotai';\nimport { atomWithStorage, selectAtom } from 'jotai/utils';\n// import { focusAtom } from 'jotai-optics'\nimport { atomWithLocation } from 'jotai-location';\nimport { DataSourceInstanceSettings, DataSourceJsonData } from '@grafana/data';\nimport { Dayjs } from 'dayjs';\nimport { DataFilterType, DiscoverCurrent, IntervalEnum, ShortcutItem } from 'types/type';\nimport { AggregatableEnum, DISCOVER_DEFAULT_STATUS, DISCOVER_SHORTCUTS, FieldTypeEnum, SearchableEnum } from 'utils/data';\n\nexport const locationAtom = atomWithLocation();\nexport const dataFilterAtom = atom<DataFilterType[]>([]);\nexport const discoverCurrentAtom = atom<DiscoverCurrent>(DISCOVER_DEFAULT_STATUS);\n\n// databases\nexport const databasesAtom = atom<any>([]);\nexport const settingDatabasesAtom = atom<any>([]);\nexport const tablesAtom = atom<any>([]);\nexport const settingTablesAtom = atom<any>([]);\n\nexport const currentCatalogAtom = atom('internal');\nexport const searchTypeAtom = atom<'SQL' | 'Search' | 'Lucene'>('Lucene');\nexport const currentDatabaseAtom = selectAtom(discoverCurrentAtom, current => current.database);\nexport const currentTableAtom = atom<string>('');\nexport const currentClusterAtom = atom('');\nexport const currentTimeFieldAtom = selectAtom(discoverCurrentAtom, current => current.timeField);\nexport const currentDateAtom = atom<Dayjs[]>(DISCOVER_SHORTCUTS[2].range());\nexport const currentIndexAtom = atom<any>([]);\nexport const selectedIndexesAtom = atom<any>([]);\nexport const searchValueAtom = atom('');\nexport const searchFocusAtom = atom(false);\nexport const activeShortcutAtom = atom<ShortcutItem | undefined>(DISCOVER_SHORTCUTS[2]);\nexport const dorisInfoAtom = atom<any>({});\nexport const disabledOptionsAtom = atom<string[]>([]);\n\nexport const selectedFieldsAtom = atom<any[]>([]);\nexport const tableFieldsAtom = atom<any[]>([]);\n\nexport const timeFieldsAtom = atom<any[]>([]);\nexport const tableDataAtom = atom<any[]>([]);\nexport const topDataAtom = atom<any[]>([]);\nexport const surroundingTableDataAtom = atom<any[]>([]);\nexport const tableDataChartsAtom = atom<any[]>([]);\nexport const intervalAtom = atom<IntervalEnum>(IntervalEnum.Auto);\nexport const tableTotalCountAtom = atom<number>(0);\nexport const tableEChartsDataAtom = atom<any[]>([]);\nexport const tableTracesDataAtom = atom<any>();\n\n// Filter Content Atom\nexport const searchableAtom = atom<SearchableEnum>(SearchableEnum.ANY);\nexport const aggregatableAtom = atom<AggregatableEnum>(AggregatableEnum.ANY);\nexport const fieldTypeAtom = atom<FieldTypeEnum>(FieldTypeEnum.ANY);\nexport const indexesAtom = atom<any[]>([]);\nexport const selectedRowAtom = atom<any>({});\nexport const tableFieldValuesAtom = atom<Array<{ label: string; value: string }>>([]);\n\nexport const pageAtom = atom<number>(1);\nexport const pageSizeAtom = atomWithStorage<number>('discover-pagination-size', 50);\n\n// Surrounding Data Atoms\nexport const surroundingDataFilterAtom = atom<DataFilterType[]>([]);\nexport const beforeTimeFieldPageSizeAtom = atom<number>(5);\nexport const afterTimeFieldPageSizeAtom = atom<number>(5);\nexport const beforeTimeAtom = atom<string>('');\nexport const afterTimeAtom = atom<string>('');\nexport const beforeCountAtom = atom<number>(0);\nexport const afterCountAtom = atom<number>(0);\nexport const surroundingTableFieldsAtom = atom<any[]>([]);\nexport const surroundingSelectedFieldsAtom = atom<any[]>([]);\n\nexport const datasourcesAtom = atom<Array<DataSourceInstanceSettings<DataSourceJsonData>>>([]);\nexport const selectedDatasourceAtom = atom<DataSourceInstanceSettings<DataSourceJsonData>>();\nexport const timeRangeAtom = atom<any>({\n    from: DISCOVER_SHORTCUTS[2].range()[0].toDate(),\n    to: DISCOVER_SHORTCUTS[2].range()[1].toDate(),\n    raw: DISCOVER_SHORTCUTS[2].raw,\n});\n\n\nexport const discoverLoadingAtom = atom({\n    getTableData: false,\n    getTopData: false,\n    getSurroundingData: false,\n    getTableDataCharts: false,\n    getTableFieldValues: false,\n    getIndexes: false,\n    getTimeFields: false,\n    getTableFields: false,\n});\n","import { getAutoInterval } from '../constants';\nimport dayjs, { Dayjs, ManipulateType } from 'dayjs';\nimport { flatten, orderBy, some } from 'lodash-es';\nimport { nanoid } from 'nanoid';\nimport { DiscoverCurrent, DataFilterType, AutoInterval, IntervalEnum } from 'types/type';\nimport jsTokens from 'js-tokens';\nimport localeData from 'dayjs/plugin/localeData';\nimport { DataFrame, FieldType } from '@grafana/data';\nimport utc from 'dayjs/plugin/utc';\nimport { isIgnorableHighlightToken } from './utils';\ndayjs.extend(utc);\ndayjs.extend(localeData);\n\nexport const OPERATORS: string[] = [\n    '=',\n    '!=',\n    'in',\n    'not in',\n    'is null',\n    'is not null',\n    'like',\n    'not like',\n    'between',\n    'not between',\n    'match_any',\n    'match_all',\n    'match_phrase',\n    'match_phrase_prefix',\n];\nexport const SQL_OPERATORS: string[] = ['=', '!=', '>', '<', '>=', '<=', 'LIKE', 'IN', 'AND', 'OR', 'BETWEEN'];\nexport const TIME_FIELD_TYPES = ['DATETIME', 'DATE', 'DATETIMEV2', 'DATEV2', 'TIME'];\nexport function isValidTimeFieldType(fieldType: string): boolean {\n    // 提取基础字段类型（移除括号及其内容）\n    const baseFieldType = fieldType.split('(')[0];\n    return TIME_FIELD_TYPES.includes(baseFieldType);\n}\nexport const CAN_SEARCH_FIELD_TYPE = ['STRING', 'ARRAY', 'NUMBER', 'VARIANT'];\nexport const ENABLE_SEARCH_FIELD_TYPE = ['DATETIME', 'TIMESTAMP', 'TIME'];\nexport const getFieldType = (columnType: string | undefined) => {\n    if (!columnType) {\n        return '';\n    }\n    const currentColumnType = FIELD_TYPES.find(item => item.value.some(val => columnType.toLocaleUpperCase().includes(val)));\n    return currentColumnType?.key;\n};\n\nexport const DISCOVER_DEFAULT_STATUS: DiscoverCurrent = {\n    catalog: 'internal',\n    database: '',\n    table: '',\n    cluster: '',\n    timeField: '',\n    date: [],\n};\n\nexport enum SearchableEnum {\n    ANY = 'ANY',\n    YES = 'YES',\n    NO = 'NO',\n}\nexport enum AggregatableEnum {\n    ANY = 'ANY',\n    YES = 'YES',\n    NO = 'NO',\n}\n\nexport const SEARCHABLE = [\n    {\n        label: `Any`,\n        value: SearchableEnum.ANY,\n    },\n    {\n        label: 'Yes',\n        value: SearchableEnum.YES,\n    },\n    {\n        label: 'No',\n        value: SearchableEnum.NO,\n    },\n];\n\nexport const AGGREGATABLE = [\n    {\n        label: `Any`,\n        value: AggregatableEnum.ANY,\n    },\n    {\n        label: 'Yes',\n        value: AggregatableEnum.YES,\n    },\n    {\n        label: 'No',\n        value: AggregatableEnum.NO,\n    },\n];\n\nexport enum FieldTypeEnum {\n    ANY = 'ANY',\n    STRING = 'STRING',\n    NUMBER = 'NUMBER',\n    DATE = 'DATE',\n}\n\nexport enum ParamsKeyEnum {\n    sqlCatalog = 'sqlCatalog',\n    sqlDatabase = 'sqlDatabase',\n    startDate = 'startDateRange',\n    endDate = 'endDateRange',\n    sqlSearch = 'sqlSearch',\n    selectedTable = 'selectedTable',\n    dateInterval = 'dateInterval',\n    selectedField = 'selectedField',\n    dataFilter = 'dataFilter',\n    selectedTimeField = 'selectedTimeField',\n    sortedField = 'sortedField',\n    searchType = 'searchType',\n    selectedIndex = 'selectedIndex',\n    selectedCluster = 'selectedCluster',\n}\n\nexport function getFilterSQL({ fieldName, operator, value }: DataFilterType): string {\n    const valueString = value.map((e: any) => {\n        if (typeof e === 'string') {\n            return `'${e}'`;\n        } else {\n            return e;\n        }\n    });\n\n    if (\n        operator === '=' ||\n        operator === '!=' ||\n        operator === 'like' ||\n        operator === 'not like' ||\n        operator === 'match_all' ||\n        operator === 'match_any' ||\n        operator === 'match_phrase' ||\n        operator === 'match_phrase_prefix'\n    ) {\n        return `\\`${fieldName}\\` ${operator} ${valueString[0]}`;\n    }\n\n    if (operator === 'is null' || operator === 'is not null') {\n        return `\\`${fieldName}\\` ${operator}`;\n    }\n\n    if (operator === 'between' || operator === 'not between') {\n        return `\\`${fieldName}\\` ${operator} ${valueString[0]} AND ${valueString[1]}`;\n    }\n\n    if (operator === 'in' || operator === 'not in') {\n        return `\\`${fieldName}\\` ${operator} (${valueString})`;\n    }\n\n    return '';\n}\n\nexport function addSqlFilter(sql: string, dataFilterValue: DataFilterType): string {\n    let result = sql;\n    if (!sql.toUpperCase().includes('WHERE')) {\n        result += ' WHERE';\n    } else {\n        result += ' AND';\n    }\n\n    result += ` (${getFilterSQL(dataFilterValue)})`;\n\n    return result;\n}\n\nfunction isWrappedInQuotes(inputString: string): boolean {\n    const pattern = /([\"'])(.*?)\\1/;\n    return pattern.test(inputString);\n}\n\nexport function getIndexesStatement(indexes: any[], allField: any[], keywords: string) {\n    let operator: 'MATCH_ANY' | 'MATCH_PHRASE' | 'MATCH_PHRASE_PREFIX' | '=' = 'MATCH_ANY';\n\n    let searchValue = keywords.trim();\n\n    if (!searchValue || !indexes) {\n        return '';\n    }\n\n    if (isWrappedInQuotes(keywords)) {\n        operator = 'MATCH_PHRASE';\n    } else {\n        searchValue = `'${searchValue}'`;\n    }\n    const indexesNames = indexes.map(item => item.columnName);\n    return indexesNames.reduce((prevValue, currValue) => {\n        const currentField = allField.find(field => `${field.value}` === currValue);\n        const currentFieldType = getFieldType(currentField.Type)?.toUpperCase();\n        if (currentFieldType === 'NUMBER') {\n            operator = '=';\n        }\n        if (currentFieldType === 'STRING' || currentFieldType === 'ARRAY') {\n            if (isWrappedInQuotes(keywords)) {\n                operator = 'MATCH_PHRASE';\n            } else {\n                operator = 'MATCH_ANY';\n            }\n        }\n        const canSearchField = CAN_SEARCH_FIELD_TYPE.includes(currentFieldType as string);\n        if (canSearchField) {\n            if (prevValue) {\n                return `${prevValue} OR \\`${currValue}\\` ${operator} ${searchValue}`;\n            } else {\n                return `\\`${currValue}\\` ${operator} ${searchValue}`;\n            }\n        }\n        return prevValue;\n    }, '');\n}\n\nexport const DISCOVER_SHORTCUTS = [\n    {\n        key: nanoid(),\n        text: `Last 5 Minutes`,\n        label: `Last 5 Minutes`,\n        range: (now: dayjs.Dayjs = dayjs()) => [now.add(-5, 'minute').startOf('second'), now],\n        format: 'HH:mm',\n        raw: {\n            from: 'now-5m',\n            to: 'now',\n        },\n        type: 'minute',\n        number: -5,\n    },\n    {\n        key: nanoid(),\n        text: `Last 15 Minutes`,\n        label: `Last 15 Minutes`,\n        raw: {\n            from: 'now-15m',\n            to: 'now',\n        },\n        range: (now: dayjs.Dayjs = dayjs()) => [now.add(-15, 'minute').startOf('second'), now],\n        format: 'HH:mm',\n        type: 'minute',\n        number: -15,\n    },\n    {\n        key: nanoid(),\n        text: `Last 1 Hour`,\n        label: `Last 1 Hour`,\n        raw: {\n            from: 'now-1h',\n            to: 'now',\n        },\n        range: (now: dayjs.Dayjs = dayjs()) => [now.add(-1, 'hour').startOf('second'), now],\n        format: 'HH:mm',\n        type: 'hour',\n        number: -1,\n    },\n    {\n        key: nanoid(),\n        text: `Last 1 Day`,\n        label: `Last 1 Day`,\n        raw: {\n            from: 'now-1d',\n            to: 'now',\n        },\n        range: (now: dayjs.Dayjs = dayjs()) => [now.add(-1, 'day').startOf('second'), now],\n        format: 'HH:mm',\n        type: 'day',\n        number: -1,\n    },\n    {\n        key: nanoid(),\n        text: `Last 7 Days`,\n        label: `Last 1 Days`,\n        raw: {\n            from: 'now-7d',\n            to: 'now',\n        },\n        range: (now: dayjs.Dayjs = dayjs()) => [now.add(-7, 'day').startOf('second'), now],\n        format: 'HH:mm',\n        type: 'day',\n        number: -7,\n    },\n    {\n        key: nanoid(),\n        text: `Last 1 Month`,\n        label: `Last 1 Month`,\n        raw: {\n            from: 'now-1M',\n            to: 'now',\n        },\n        range: (now: dayjs.Dayjs = dayjs()) => [now.add(-1, 'month').startOf('second'), now],\n        format: 'HH:mm',\n        type: 'month',\n        number: -1,\n    },\n    {\n        key: nanoid(),\n        text: `Last 3 Months`,\n        label: `Last 3 Months`,\n        raw: {\n            from: 'now-3M',\n            to: 'now',\n        },\n        range: (now: dayjs.Dayjs = dayjs()) => [now.add(-3, 'month').startOf('second'), now],\n        format: 'HH:mm',\n        type: 'month',\n        number: -3,\n    },\n    {\n        key: nanoid(),\n        text: `Last 1 Year`,\n        label: `Last 1 Year`,\n        raw: {\n            from: 'now-1y',\n            to: 'now',\n        },\n        range: (now: dayjs.Dayjs = dayjs()) => [now.add(-1, 'year').startOf('second'), now],\n        format: 'HH:mm',\n        type: 'year',\n        number: -1,\n    },\n];\n\nexport const SURROUNDING_LOGS_OPERATORS = [\n    {\n        label: '5',\n        value: '5',\n    },\n    {\n        label: '10',\n        value: '10',\n    },\n];\n\nexport function getLatestTime(id: string) {\n    if (!id) {\n        return null;\n    }\n    const selectedItem = DISCOVER_SHORTCUTS.find(item => item.key === id);\n    return selectedItem?.range();\n}\n\nexport const TIME_INTERVALS = [\n    {\n        value: 'auto',\n        label: `Auto`,\n    },\n    {\n        value: 'second',\n        label: `Second`,\n    },\n    {\n        value: 'minute',\n        label: `Minute`,\n    },\n    {\n        value: 'hour',\n        label: `Hour`,\n    },\n    {\n        value: 'day',\n        label: `Day`,\n    },\n    {\n        value: 'week',\n        label: `Week`,\n    },\n    {\n        value: 'month',\n        label: `Month`,\n    },\n    {\n        value: 'year',\n        label: `Year`,\n    },\n];\n\nexport const PAGESIZE_OPTIONS = [10, 20, 50, 100, 200];\n\nexport const FIELD_TYPES = [\n    {\n        key: 'STRING',\n        value: ['VARCHAR', 'STRING', 'CHAR', 'TEXT'],\n        icon: '',\n    },\n    {\n        key: 'NUMBER',\n        value: ['INT', 'LARGEINT', 'SMALLINT', 'TINYINT', 'DECIMAL', 'BIGINT', 'FLOAT', 'DOUBLE'],\n        icon: '',\n    },\n    {\n        key: 'DATE',\n        value: ['DATE', 'DATETIME', 'DATEV2', 'DATETIMEV2'],\n        icon: '',\n    },\n    {\n        key: 'JSONB',\n        value: ['JSONB'],\n        icon: '',\n        complex: true,\n    },\n    {\n        key: 'ARRAY',\n        value: ['ARRAY'],\n        icon: '',\n        complex: true,\n    },\n    {\n        key: 'BOOLEAN',\n        value: ['BOOLEAN'],\n        icon: '',\n    },\n    {\n        key: 'BITMAP',\n        value: ['BITMAP'],\n        icon: '',\n        complex: true,\n    },\n    {\n        key: 'HLL',\n        value: ['HLL'],\n        icon: '',\n        complex: true,\n    },\n    {\n        key: 'VARIANT',\n        value: ['VARIANT'],\n        icon: '',\n        complex: true,\n    },\n    {\n        key: 'JSON',\n        value: ['JSON'],\n        icon: '',\n        complex: true,\n    },\n];\n\nexport function encodeBase64(str: string) {\n    return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g, (match, p1) => String.fromCharCode(parseInt('0x' + p1, 10))));\n}\n\nexport function decodeBase64(base64: string) {\n    return decodeURIComponent(\n        Array.from(atob(base64))\n            .map(c => '%' + c.charCodeAt(0).toString(16).padStart(2, '0'))\n            .join(''),\n    );\n}\n\nexport const isComplexType = (columnType: string | undefined) => {\n    if (!columnType) {\n        return false;\n    }\n    const currentColumnType = FIELD_TYPES.find(item => item.value.some(val => columnType.toLocaleUpperCase().includes(val)));\n    if (currentColumnType) {\n        return !!currentColumnType.complex;\n    }\n    return true;\n};\n\nexport function formatDate(interval: ManipulateType) {\n    let date_format = 'YYYY-MM-DD HH:mm:ss';\n    switch (interval) {\n        case 'year':\n            date_format = 'YYYY';\n            break;\n        case 'month':\n            date_format = 'YYYY-MM';\n            break;\n        case 'week':\n            date_format = 'YYYY-MM-DD';\n            break;\n        case 'day':\n            date_format = 'YYYY-MM-DD';\n            break;\n        case 'hour':\n            date_format = 'YYYY-MM-DD HH:mm:ss';\n            break;\n        case 'minute':\n            date_format = 'YYYY-MM-DD HH:mm:ss';\n            break;\n        case 'second':\n        default:\n            date_format = 'YYYY-MM-DD HH:mm:ss';\n            break;\n    }\n    return date_format;\n}\n\nexport function resetDate(date: Dayjs, interval: ManipulateType) {\n    let date_reset = date;\n    switch (interval) {\n        case 'year':\n            date_reset.set('month', 1).set('date', 1).set('hour', 0).set('minute', 0).set('second', 0);\n            break;\n        case 'month':\n            date_reset.set('date', 1).set('hour', 0).set('minute', 0).set('second', 0);\n            break;\n        case 'week':\n            date_reset.set('hour', 0).set('minute', 0).set('second', 0);\n            break;\n        case 'day':\n            date_reset.set('hour', 0).set('minute', 0).set('second', 0);\n            break;\n        case 'hour':\n            date_reset.set('minute', 0).set('second', 0);\n            break;\n        case 'minute':\n            date_reset.set('second', 0);\n            break;\n        case 'second':\n        default:\n            break;\n    }\n    return date_reset;\n}\n\nexport function getDateRange(startDate: Dayjs, endDate: Dayjs, interval: any) {\n    const DATE_FORMAT = formatDate(interval.interval_unit);\n    if (dayjs(startDate, DATE_FORMAT).isSame(dayjs(endDate, DATE_FORMAT), interval.interval_unit)) {\n        return [endDate];\n    }\n    let date: any = resetDate(startDate, interval.interval_unit);\n    const formatStartDate = date.format(DATE_FORMAT);\n    const dates = [formatStartDate];\n    do {\n        date = dayjs(date).add(interval.interval_value, interval.interval_unit);\n        if (dayjs(date).isBefore(endDate)) {\n            dates.push(date.format(DATE_FORMAT));\n        }\n    } while (dayjs(date).isBefore(endDate));\n    return dates;\n}\n\nexport function getChartsData(tableDataCharts: any[], currentDate: [Dayjs, Dayjs]) {\n    const selectInterval: AutoInterval = getAutoInterval(currentDate);\n    const [startDate, endDate] = currentDate;\n    const intervalUnit: any = selectInterval.interval_unit || IntervalEnum.Auto;\n    const timeInterval: any = intervalUnit === IntervalEnum.Auto ? selectInterval : { interval_value: 1, interval_unit: intervalUnit };\n    const dates = getDateRange(startDate as Dayjs, endDate as Dayjs, timeInterval);\n    const tableDataMap = new Map();\n    const result: any[] = [];\n    const DATE_FORMAT_FROM_INTERVAL = formatDate(timeInterval.interval_unit);\n\n    tableDataCharts.forEach(e => {\n        const currentLocale = dayjs.locale();\n        const date = dayjs.utc(e['TT']).locale(currentLocale).format(DATE_FORMAT_FROM_INTERVAL);\n        tableDataMap.set(date, e['sum(cnt)']);\n    });\n    dates.forEach(date => {\n        const newDate = dayjs(date).format(DATE_FORMAT_FROM_INTERVAL);\n        if (!tableDataMap.get(newDate)) {\n            tableDataMap.set(newDate, null);\n        }\n    });\n\n    tableDataMap.forEach((value, key) => {\n        result.push({\n            TT: key,\n            ['sum(cnt)']: value,\n        });\n    });\n    return orderBy(result, ['TT'], ['asc']);\n}\n\nexport function convertColumnToRow(frame: any): Array<Record<string, any>> {\n    const fieldNames = frame.schema.fields.map((f: any) => f.name);\n    const columns = frame.data.values;\n\n    if (columns.length === 0) {\n        return [];\n    }\n\n    const numRows = columns[0].length;\n    const rows: Array<Record<string, any>> = [];\n\n    for (let i = 0; i < numRows; i++) {\n        const row: Record<string, any> = {};\n        for (let j = 0; j < columns.length; j++) {\n            row[fieldNames[j]] = columns[j][i];\n            if (isValidTimeFieldType(frame.schema.fields[j].type.toUpperCase())) {\n                // 如果是时间字段，转换为 Dayjs 对象\n                row[fieldNames[j]] = formatTimestampToDateTime(row[fieldNames[j]], frame.schema.fields[j].precision || 3);\n            }\n            if (frame.schema.fields[j].type === 'VARIANT') {\n                // 如果是 VARIANT 类型，转换为 JSON 对象\n                try {\n                    row[fieldNames[j]] = JSON.parse(row[fieldNames[j]]);\n                } catch (e) {\n                    console.error(`Error parsing VARIANT field ${fieldNames[j]}:`, e);\n                }\n            }\n        }\n        rows.push(row);\n    }\n\n    return rows;\n}\n\n// 通过查询 Doris 的字段判断类型，不依赖 Grafana 类型\nexport function convertColumnToRowViaFieldsType(frame: any, fields: any): Array<Record<string, any>> {\n    const fieldNames = frame.schema.fields.map((f: any) => f.name);\n    const columns = frame.data.values;\n\n    if (columns.length === 0) {\n        return [];\n    }\n\n    const numRows = columns[0].length;\n    const rows: Array<Record<string, any>> = [];\n\n    for (let i = 0; i < numRows; i++) {\n        const row: Record<string, any> = {};\n        for (let j = 0; j < columns.length; j++) {\n            row[fieldNames[j]] = columns[j][i];\n            if (isValidTimeFieldType(frame.schema.fields[j].type.toUpperCase())) {\n                // 如果是时间字段，转换为 Dayjs 对象\n                row[fieldNames[j]] = formatTimestampToDateTime(row[fieldNames[j]], frame.schema.fields[j].precision || 3);\n                // row[fieldNames[j]] = dayjs.utc(row[fieldNames[j]]).locale(currentLocale).format('YYYY-MM-DD HH:mm:ss.SSS');\n            }\n            const currentFieldInfo = fields.filter((item: any) => item.Field === frame.schema.fields[j].name)[0];\n            // 如果是 VARIANT 类型，转换为 JSON 对象\n            if (currentFieldInfo && currentFieldInfo.Type.toUpperCase() === 'VARIANT') {\n                try {\n                    row[fieldNames[j]] = JSON.parse(row[fieldNames[j]]);\n                } catch (e) {\n                    console.error(`Error parsing VARIANT field ${fieldNames[j]}:`, e);\n                }\n            }\n        }\n        rows.push(row);\n    }\n\n    return rows;\n}\n\n// 格式化时间戳为 DATETIME([number]) 格式\nexport function formatTimestampToDateTime(timestamp: any, precision = 3) {\n    const currentLocale = dayjs.locale();\n    // 基础格式：YYYY-MM-DD HH:mm:ss\n    let formatString = 'YYYY-MM-DD HH:mm:ss';\n\n    // 根据精度添加毫秒部分\n    if (precision > 0) {\n        formatString += `.${'S'.repeat(precision)}`;\n    }\n    // 转换时间戳并格式化\n    return dayjs.utc(timestamp).locale(currentLocale).format(formatString);\n}\n\nexport function formatTracesResData(frame: any) {\n    const { data } = frame;\n    const traceDataFrame: DataFrame = {\n        name: 'Trace ID',\n        refId: frame.schema?.refId || 'Trace ID',\n        fields: frame.schema?.fields.map((f: any, i: number) => ({\n            name: f.name,\n            type: f.type,\n            values: data.values[i],\n            typeInfo: f.typeInfo,\n            config: {},\n        })),\n        length: data.values[0].length,\n    };\n    try {\n        traceDataFrame.fields.forEach(f => {\n            if (f.name === 'serviceTags' || f.name === 'tags') {\n                f.type = FieldType.other;\n                f.values = f.values.map(item => JSON.parse(item));\n            }\n        });\n    } catch (err) {\n        console.log('err:', err);\n    }\n    console.log('traceDataFrame', traceDataFrame);\n    return traceDataFrame;\n}\n\nfunction getSearchTableData(tokenizeFields: any[], tableResult: any[]) {\n    const result: any = [...tokenizeFields];\n    tableResult.forEach(tableItem => {\n        result.forEach((token: any) => {\n            token['searchValue'] = tableItem[token.columnName];\n        });\n    });\n    return result;\n}\n\nfunction searchField(data: any[], searchString: string) {\n    return some(data, item => item.columnName === searchString);\n}\n\nfunction parseKeywords(keyword: string) {\n    if (keyword.length >= 2 && keyword[0] === keyword[keyword.length - 1] && (keyword[0] === `'` || keyword[0] === `\"`)) {\n        keyword = keyword.substring(1, keyword.length - 1);\n    }\n    return keyword;\n}\n\nfunction highlightDelimiter(inputStr: string, delimiter: string) {\n    const highlighted = inputStr.replace(new RegExp(`${delimiter}`, 'g'), `<mark>${delimiter}</mark>`);\n    return highlighted;\n}\n\nfunction insertUnderscore(arr: string[]) {\n    return arr.reduce((result: string[], item: string, index) => {\n        result.push(item);\n        if (index < arr.length - 1) {\n            result.push('_');\n        }\n        return result;\n    }, []);\n}\n\nfunction compare_ignore_quotes(s1: string, s2: string) {\n    // 移除双引号和单引号\n    const cleanS1 = s1.replace(/['\"]/g, '');\n    const cleanS2 = s2.replace(/['\"]/g, '');\n    // 比较\n    return cleanS1 === cleanS2;\n}\n\ntype SearchResultItem = { [key: string]: any };\nexport function generateHighlightedResults(data: { search_value: string; indexes: string[] }, result: SearchResultItem[]) {\n    const keyword: string = data.search_value || '';\n    const searchTableData = getSearchTableData(data.indexes, result);\n\n    // Detect simple Lucene \"field:value\" pattern so we can highlight the specified field\n    // even when `indexes` (tokenizeFields) is empty. Example: \"service_name:frontend\"\n    const luceneFieldMatch = keyword && keyword.match(/^\\s*([^\\s:]+)\\s*:/);\n    const luceneField = luceneFieldMatch ? luceneFieldMatch[1].replace(/['\"]+/g, '') : null;\n\n    const keywordsTokens: string[] = flatten(\n        Array.from(jsTokens(keyword))\n            .filter(item => item.type !== 'Punctuator')\n            .map(item => {\n                let res = item.value.toLowerCase();\n                return item.value.includes('_') ? item.value.split('_').map(str => str.toLowerCase()) : res;\n            }),\n    );\n\n    const _sourceResult = result.map(item => {\n        let itemSource = '';\n\n        for (const key in item) {\n            let highlightValue: any = item[key];\n            let itemValue: any = item[key];\n\n            if (typeof highlightValue === 'object') {\n                highlightValue = JSON.stringify(highlightValue);\n                itemValue = JSON.stringify(itemValue);\n            }\n\n            if (keyword && (searchField(searchTableData, key) || (luceneField && key === luceneField))) {\n                const strValue = typeof itemValue === 'string' ? itemValue : itemValue + '';\n\n                if (isWrappedInQuotes(keyword)) {\n                    const parsedKeyword = parseKeywords(keyword);\n                    if (parsedKeyword === strValue) {\n                        highlightValue = `<mark>${itemValue}</mark>`;\n                    } else if (strValue.includes(parsedKeyword)) {\n                        highlightValue = highlightDelimiter(strValue, parsedKeyword);\n                    }\n                } else {\n                    const tokenizedAns = Array.from(jsTokens(strValue)).map(item => item.value);\n                    let ans: string[] = [];\n\n                    if (tokenizedAns.includes(keyword)) {\n                        ans = tokenizedAns;\n                    } else {\n                        const ansWithUnderscore = flatten(\n                            tokenizedAns.map(item => {\n                                if (item.includes('_')) {\n                                    return insertUnderscore(item.split('_'));\n                                }\n                                return item;\n                            }),\n                        );\n                        ans = ansWithUnderscore;\n                    }\n\n                    if (ans.length > 0) {\n                        highlightValue = ans.reduce((acc: string, curr: string) => {\n                            if (\n                                keywordsTokens.filter(token => !isIgnorableHighlightToken(token)).find(token => compare_ignore_quotes(token, curr.toLowerCase())) ||\n                                compare_ignore_quotes(keyword.toLowerCase(), curr.toLowerCase())\n                            ) {\n                                return acc + `<mark>${curr}</mark>`;\n                            }\n                            return acc + curr;\n                        }, '');\n                    }\n                }\n            }\n\n            // ✅ 这里改成用 data-trace-id + class，方便事件委托识别\n            if (key === 'trace_id') {\n                const traceId = typeof itemValue === 'string' ? itemValue : String(itemValue);\n\n                const content = highlightValue || traceId;\n\n                highlightValue = `<a \n                href=\"javascript:void(0)\" \n                class=\"trace-link\" \n                data-trace-id=\"${traceId}\"\n            >${content}</a>`;\n            }\n\n            itemSource += `<span class=\"field-key\">${key}:</span>${highlightValue} `;\n        }\n\n        return {\n            _original: item,\n            _source: itemSource.trim(),\n        };\n    });\n\n    return _sourceResult;\n}\n\nexport const QUERY_TRACE_FIELDS = ['trace_id','span_id','parent_span_id','span_name','service_name']\n\n","import dayjs, { Dayjs, ManipulateType } from \"dayjs\";\n\nexport interface QueryTableDataParams {\n    catalog: string;\n    database: string;\n    table: string;\n    cluster: string;\n    startDate: string;\n    endDate: string;\n    sort: string;\n    timeField: string;\n    data_filters: any[];\n    interval?: IntervalEnum;\n    interval_value?: number;\n    search_type: string;\n    search_value: string;\n    indexes?: string;\n    indexes_statement?: string;\n    page: string;\n    page_size: number;\n    lucene_where?: string;\n}\n\n\nexport interface SurroundingParams {\n    catalog: string;\n    database: string;\n    table: string;\n    cluster: string;\n    timeField: string;\n    time: string;\n    data_filters: any;\n    pageSize: string;\n    operator: '>' | '<';\n    theme: string | undefined;\n}\n\nexport interface DataFilterType {\n    fieldName: string;\n    operator: Operator;\n    value: Array<string | number>;\n    label?: string;\n    id: string;\n}\n\nexport type Operator =\n    | '='\n    | '!='\n    | 'in'\n    | 'not in'\n    | 'is null'\n    | 'is not null'\n    | 'between'\n    | 'not between'\n    | 'like'\n    | 'not like'\n    | 'match_all'\n    | 'match_any'\n    | 'match_phrase'\n    | 'match_phrase_prefix';\n\nexport interface DiscoverCurrent {\n    catalog: string;\n    database: string;\n    table: string;\n    cluster: string;\n    timeField: string;\n    date: [Dayjs, Dayjs] | [];\n}\n\nexport enum IntervalEnum {\n    Auto = 'auto',\n    Day = 'day',\n    Week = 'week',\n    Month = 'month',\n    Year = 'year',\n    Hour = 'hour',\n    Minute = 'minute',\n    Second = 'second',\n}\n\n\nexport type ShortcutItem = {\n    key: string;\n    text: string;\n    label: string;\n    range: (now?: dayjs.Dayjs) => dayjs.Dayjs[];\n    format: string;\n    type: string;\n    number: number;\n}\n\nexport interface QueryTableFieldsParams {\n    catalog: string;\n    database: string;\n    table: string;\n    describe_extend_variant_column?: string;\n}\n\nexport type FieldNode = {\n    name: string;\n    type: string;\n    children?: FieldNode[];\n    Null?: string;\n    Key?: string;\n    Default?: string | null;\n    Extra?: string;\n    Comment?: string;\n    Visible?: string;\n};\n\n\nexport interface RequestParams {\n    catalog: string;\n    database: string;\n    table: string;\n    describe_extend_variant_column?: boolean;\n}\n\nexport interface QueryTableIndexesParams {\n    catalog: string;\n    database: string;\n    table: string\n}\n\nexport interface QueryTableParams {\n    catalog: string;\n    database: string;\n}\n\nexport type AutoInterval = {\n    current_date_range: number;\n    current_type: ManipulateType;\n    interval_unit: ManipulateType;\n    interval_value: number;\n};\n\n\nexport type Frame = {\n    schema: {\n        fields: Array<{ name: string }>;\n    };\n    data: {\n        values: any[][];\n    };\n};\n\nexport type Result = {\n    frames: Frame[];\n};\n\nexport type Root = {\n    results: Record<string, Result>;\n};\n\nexport type QueryTracesParams = {\n    database: string;\n    table: string;\n    timeField: string;\n    startDate: string;\n    endDate: string;\n    service_name?: string;\n    operation?: string;\n    statusCode?: string;\n    minDuration?: string;\n    maxDuration?: string;\n    tags?: string;\n    page?: number;\n    page_size?: number;\n    sortBy?: string;\n};\n\nexport type TracesServicesParams = {\n  table: string;\n  timeField: string;\n  startDate: string;\n  endDate: string;\n};\n\nexport type TracesOperationsParams = {\n  table: string;\n  timeField: string;\n  startDate: string;\n  endDate: string;\n  service_name: string;\n};\n","import { toDataFrame } from '@grafana/data';\nimport { getBackendSrv } from '@grafana/runtime';\nimport { lastValueFrom } from 'rxjs';\n\ntype GetColumnParams = {\n    connectionId: string;\n    database: string;\n    table: string;\n    column: string;\n    datasourceType?: string;\n};\n\ntype ColumnMetadata = {\n    name: string;\n    dataType?: string;\n    columnType?: string;\n};\n\ntype GetIndexesParams = {\n    connectionId: string;\n    database: string;\n    table: string;\n    datasourceType?: string;\n};\n\nconst escapeSqlLiteral = (value: string) => value.replace(/'/g, \"''\");\n\nconst normalizeColumnType = ({ dataType, columnType }: { dataType?: string; columnType?: string }): string => {\n    const source = (columnType || dataType || '').trim();\n    if (!source) {\n        return '';\n    }\n\n    const lower = source.toLowerCase();\n\n    if (lower.startsWith('nullable(') && lower.endsWith(')')) {\n        const inner = source.slice(9, -1);\n        const normalizedInner = normalizeColumnType({ dataType: inner, columnType: undefined });\n        return normalizedInner ? `Nullable(${normalizedInner})` : source;\n    }\n\n    if (lower.startsWith('map')) {\n        return source.replace(/^map/i, 'Map');\n    }\n\n    if (lower.startsWith('array')) {\n        return source.replace(/^array/i, 'Array');\n    }\n\n    if (lower.startsWith('json') || lower.startsWith('variant')) {\n        return 'JSON';\n    }\n\n    if (lower === 'bool' || lower === 'boolean' || lower.startsWith('tinyint(1)')) {\n        return 'Bool';\n    }\n\n    if (lower.startsWith('tinyint')) {\n        return 'Int8';\n    }\n\n    if (lower.startsWith('smallint')) {\n        return 'Int16';\n    }\n\n    if (lower.startsWith('mediumint')) {\n        return 'Int32';\n    }\n\n    if (lower.startsWith('bigint') || lower.startsWith('int') || lower.startsWith('integer')) {\n        return 'Int64';\n    }\n\n    if (lower.startsWith('float') || lower.startsWith('double') || lower.startsWith('real')) {\n        return 'Float64';\n    }\n\n    if (lower.startsWith('decimal') || lower.startsWith('numeric')) {\n        return 'Float64';\n    }\n\n    if (lower.startsWith('date')) {\n        return source.replace(/^date/i, 'Date');\n    }\n\n    if (lower.startsWith('timestamp') || lower.startsWith('datetime')) {\n        return 'DateTime';\n    }\n\n    if (lower.startsWith('enum')) {\n        return source.replace(/^enum/i, 'Enum');\n    }\n\n    if (lower.startsWith('uuid')) {\n        return 'UUID';\n    }\n\n    if (lower.startsWith('ipv4')) {\n        return 'IPv4';\n    }\n\n    if (lower.startsWith('ipv6')) {\n        return 'IPv6';\n    }\n\n    if (lower.startsWith('tuple')) {\n        return source.replace(/^tuple/i, 'Tuple');\n    }\n\n    if (lower.startsWith('struct')) {\n        return source.replace(/^struct/i, 'Tuple');\n    }\n\n    if (lower.startsWith('char') || lower.startsWith('varchar') || lower.startsWith('text') || lower.startsWith('string')) {\n        return 'String';\n    }\n\n    return source;\n};\n\nexport async function getColumn({\n    connectionId,\n    database,\n    table,\n    column,\n    datasourceType = 'mysql',\n}: GetColumnParams): Promise<(ColumnMetadata & { normalizedType: string }) | null> {\n    if (!connectionId || !database || !table || !column) {\n        return null;\n    }\n\n    const query = `\nSELECT\n  COLUMN_NAME AS Field,\n  DATA_TYPE AS DataType,\n  COLUMN_TYPE AS ColumnType\nFROM information_schema.COLUMNS\nWHERE TABLE_SCHEMA = '${escapeSqlLiteral(database)}'\n  AND TABLE_NAME = '${escapeSqlLiteral(table)}'\n  AND COLUMN_NAME = '${escapeSqlLiteral(column)}'\nLIMIT 1;\n`;\n\n    const response$ = getBackendSrv().fetch({\n        url: '/api/ds/query',\n        method: 'POST',\n        data: {\n            queries: [\n                {\n                    refId: 'getColumn',\n                    datasource: { type: datasourceType, uid: connectionId },\n                    rawSql: query,\n                    format: 'table',\n                },\n            ],\n        },\n    });\n\n    try {\n        const { data, ok } = await lastValueFrom(response$);\n        if (!ok) {\n            return null;\n        }\n\n        const resultData = data as { results?: Record<string, any> };\n        const frame = resultData?.results?.getColumn?.frames?.[0];\n        if (!frame) {\n            return null;\n        }\n\n        const dataFrame = toDataFrame(frame);\n        const nameField = dataFrame.fields.find(field => field.name === 'Field') ?? dataFrame.fields[0];\n        const dataTypeField = dataFrame.fields.find(field => field.name === 'DataType');\n        const columnTypeField = dataFrame.fields.find(field => field.name === 'ColumnType');\n\n        const name = nameField?.values?.get?.(0);\n        if (!name) {\n            return null;\n        }\n\n        const dataTypeValue = dataTypeField?.values?.get?.(0);\n        const columnTypeValue = columnTypeField?.values?.get?.(0);\n\n        const columnInfo: ColumnMetadata = {\n            name: String(name),\n            dataType: dataTypeValue != null ? String(dataTypeValue) : undefined,\n            columnType: columnTypeValue != null ? String(columnTypeValue) : undefined,\n        };\n\n        const normalizedType = normalizeColumnType({\n            dataType: columnInfo.dataType,\n            columnType: columnInfo.columnType,\n        });\n\n        return {\n            ...columnInfo,\n            normalizedType,\n        };\n    } catch (error) {\n        console.error('Failed to fetch column metadata', error);\n        return null;\n    }\n}\n\nexport async function getInvertedIndexColumns({\n    connectionId,\n    database,\n    table,\n    datasourceType = 'mysql',\n}: GetIndexesParams): Promise<string[]> {\n    if (!connectionId || !database || !table) {\n        return [];\n    }\n\n    const query = `SHOW INDEXES FROM \\`${database}\\`.\\`${table}\\``;\n\n    const response$ = getBackendSrv().fetch({\n        url: '/api/ds/query',\n        method: 'POST',\n        data: {\n            queries: [\n                {\n                    refId: 'getInvertedIndexes',\n                    datasource: { type: datasourceType, uid: connectionId },\n                    rawSql: query,\n                    format: 'table',\n                },\n            ],\n        },\n    });\n\n    try {\n        const { data, ok } = await lastValueFrom(response$);\n        if (!ok) {\n            return [];\n        }\n\n        const resultData = data as { results?: Record<string, any> };\n        const frame =\n            resultData?.results?.getInvertedIndexes?.frames?.[0] ??\n            resultData?.results?.getIndexes?.frames?.[0];\n\n        if (!frame) {\n            return [];\n        }\n\n        const dataFrame = toDataFrame(frame);\n        const columnNameField =\n            dataFrame.fields.find(field => field.name === 'Column_name') ??\n            dataFrame.fields.find(field => field.name === 'COLUMN_NAME');\n        const indexTypeField =\n            dataFrame.fields.find(field => field.name === 'Index_type') ??\n            dataFrame.fields.find(field => field.name === 'INDEX_TYPE');\n\n        if (!columnNameField || !indexTypeField) {\n            return [];\n        }\n\n        const columnNames = Array.from(columnNameField.values ?? []);\n        const indexTypes = Array.from(indexTypeField.values ?? []);\n        const indexedColumns = new Set<string>();\n\n        for (let i = 0; i < columnNames.length; i += 1) {\n            const columnName = columnNames[i];\n            const indexType = indexTypes[i];\n            if (typeof columnName !== 'string' || columnName.length === 0) {\n                continue;\n            }\n            if (typeof indexType !== 'string') {\n                continue;\n            }\n\n            if (indexType.toUpperCase().includes('INVERT')) {\n                indexedColumns.add(columnName);\n            }\n        }\n\n        return Array.from(indexedColumns);\n    } catch (error) {\n        console.error('Failed to fetch inverted index metadata', error);\n        return [];\n    }\n}\n\n\nexport function getDatabases(selectdbDS: any) {\n    const response$ = getBackendSrv().fetch({\n        url: '/api/ds/query',\n        method: 'POST',\n        data: {\n            queries: [\n                {\n                    refId: 'getDatabases',\n                    datasource: {\n                        type: 'mysql',\n                        uid: selectdbDS.uid,\n                    },\n                    rawSql: 'SHOW DATABASES',\n                    format: 'table',\n                },\n            ],\n        },\n    });\n    return response$;\n}\n\nexport function getTablesService({ selectdbDS, database }: { selectdbDS: any; database: string }) {\n    return getBackendSrv().fetch({\n        url: '/api/ds/query',\n        method: 'POST',\n        data: {\n            queries: [\n                {\n                    refId: 'getTables',\n                    datasource: { type: 'mysql', uid: selectdbDS.uid },\n                    rawSql: `SHOW TABLES FROM \\`${database}\\``,\n                    format: 'table',\n                },\n            ],\n        },\n    });\n}\n\nexport function getFieldsService({ selectdbDS, database, table }: { selectdbDS: any; database: string; table: string }) {\n    return getBackendSrv().fetch({\n        url: '/api/ds/query',\n        method: 'POST',\n        data: {\n            queries: [\n                {\n                    refId: 'getFields',\n                    datasource: { type: 'mysql', uid: selectdbDS.uid },\n                    rawSql: `SHOW COLUMNS FROM \\`${database}\\`.\\`${table}\\``,\n                    format: 'table',\n                },\n            ],\n        },\n    });\n}\n\nexport function getColumnFromFieldService({ selectdbDS, database, table }: { selectdbDS: any; database: string; table: string }) {\n    // return getBackendSrv().fetch({\n    //     url: '/api/ds/query',\n    //     method: 'POST',\n    //     data: {\n    //         queries: [\n    //             {\n    //                 refId: 'getColumnFromFieldService',\n    //                 datasource: { type: 'mysql', uid: selectdbDS.uid },\n    //                 rawSql: `SHOW COLUMNS FROM \\`${database}\\`.\\`${table}\\``,\n    //                 format: 'table',\n    //             },\n    //         ],\n    //     },\n    // });\n}\n\nexport function getIndexesService({ selectdbDS, database, table }: { selectdbDS: any; database: string; table: string }) {\n    return getBackendSrv().fetch({\n        url: '/api/ds/query',\n        method: 'POST',\n        data: {\n            queries: [\n                {\n                    refId: 'getIndexes',\n                    datasource: { type: 'mysql', uid: selectdbDS.uid },\n                    rawSql: `SHOW INDEXES FROM \\`${database}\\`.\\`${table}\\``,\n                    format: 'table',\n                },\n            ],\n        },\n    });\n}\n"],"names":["stableStringify","value","seen","WeakSet","recur","v","t","Number","isFinite","String","JSON","stringify","toString","has","add","Array","isArray","map","join","keys","Object","sort","body","k","u8ToHex","u8","out","i","length","padStart","hasSubtle","window","crypto","isSecureContext","subtle","digest","sha256HexJS","data","K","Uint32Array","h0","h1","h2","h3","h4","h5","h6","h7","l","bitLenHi","bitLenLo","nBlocks","M","W","rotr","x","n","s0","s1","a","b","c","d","e","f","g","h","S1","ch","T1","S0","maj","T2","Uint8Array","H","sha256Hex","input","TextEncoder","encode","buf","generateUid","obj","json","generateTableDataUID","items","sources","it","_original","uids","Promise","all","_uid","isIgnorableHighlightToken","token","ignoreChars","Set","trim","test","trimSpacesAroundEquals","str","replace","atom","atomWithStorage","selectAtom","atomWithLocation","IntervalEnum","AggregatableEnum","DISCOVER_DEFAULT_STATUS","DISCOVER_SHORTCUTS","FieldTypeEnum","SearchableEnum","locationAtom","dataFilterAtom","discoverCurrentAtom","databasesAtom","settingDatabasesAtom","tablesAtom","settingTablesAtom","currentCatalogAtom","searchTypeAtom","currentDatabaseAtom","current","database","currentTableAtom","currentClusterAtom","currentTimeFieldAtom","timeField","currentDateAtom","range","currentIndexAtom","selectedIndexesAtom","searchValueAtom","searchFocusAtom","activeShortcutAtom","dorisInfoAtom","disabledOptionsAtom","selectedFieldsAtom","tableFieldsAtom","timeFieldsAtom","tableDataAtom","topDataAtom","surroundingTableDataAtom","tableDataChartsAtom","intervalAtom","Auto","tableTotalCountAtom","tableEChartsDataAtom","tableTracesDataAtom","searchableAtom","ANY","aggregatableAtom","fieldTypeAtom","indexesAtom","selectedRowAtom","tableFieldValuesAtom","pageAtom","pageSizeAtom","surroundingDataFilterAtom","beforeTimeFieldPageSizeAtom","afterTimeFieldPageSizeAtom","beforeTimeAtom","afterTimeAtom","beforeCountAtom","afterCountAtom","surroundingTableFieldsAtom","surroundingSelectedFieldsAtom","datasourcesAtom","selectedDatasourceAtom","timeRangeAtom","from","toDate","to","raw","discoverLoadingAtom","getTableData","getTopData","getSurroundingData","getTableDataCharts","getTableFieldValues","getIndexes","getTimeFields","getTableFields","getAutoInterval","dayjs","flatten","orderBy","some","nanoid","jsTokens","localeData","FieldType","utc","extend","OPERATORS","SQL_OPERATORS","TIME_FIELD_TYPES","isValidTimeFieldType","fieldType","baseFieldType","split","includes","CAN_SEARCH_FIELD_TYPE","ENABLE_SEARCH_FIELD_TYPE","getFieldType","columnType","currentColumnType","FIELD_TYPES","find","item","val","toLocaleUpperCase","key","catalog","table","cluster","date","SEARCHABLE","label","AGGREGATABLE","ParamsKeyEnum","getFilterSQL","fieldName","operator","valueString","addSqlFilter","sql","dataFilterValue","result","toUpperCase","isWrappedInQuotes","inputString","pattern","getIndexesStatement","indexes","allField","keywords","searchValue","indexesNames","columnName","reduce","prevValue","currValue","currentField","field","currentFieldType","Type","canSearchField","text","now","startOf","format","type","number","SURROUNDING_LOGS_OPERATORS","getLatestTime","id","selectedItem","TIME_INTERVALS","PAGESIZE_OPTIONS","icon","complex","encodeBase64","btoa","encodeURIComponent","match","p1","fromCharCode","parseInt","decodeBase64","base64","decodeURIComponent","atob","charCodeAt","isComplexType","formatDate","interval","date_format","resetDate","date_reset","set","getDateRange","startDate","endDate","DATE_FORMAT","interval_unit","isSame","formatStartDate","dates","interval_value","isBefore","push","getChartsData","tableDataCharts","currentDate","selectInterval","intervalUnit","timeInterval","tableDataMap","Map","DATE_FORMAT_FROM_INTERVAL","forEach","currentLocale","locale","newDate","get","TT","convertColumnToRow","frame","fieldNames","schema","fields","name","columns","values","numRows","rows","row","j","formatTimestampToDateTime","precision","parse","console","error","convertColumnToRowViaFieldsType","currentFieldInfo","filter","Field","timestamp","formatString","repeat","formatTracesResData","traceDataFrame","refId","typeInfo","config","other","err","log","getSearchTableData","tokenizeFields","tableResult","tableItem","searchField","searchString","parseKeywords","keyword","substring","highlightDelimiter","inputStr","delimiter","highlighted","RegExp","insertUnderscore","arr","index","compare_ignore_quotes","s2","cleanS1","cleanS2","generateHighlightedResults","search_value","searchTableData","luceneFieldMatch","luceneField","keywordsTokens","res","toLowerCase","_sourceResult","itemSource","highlightValue","itemValue","strValue","parsedKeyword","tokenizedAns","ans","ansWithUnderscore","acc","curr","traceId","content","_source","QUERY_TRACE_FIELDS","toDataFrame","getBackendSrv","lastValueFrom","escapeSqlLiteral","normalizeColumnType","dataType","source","lower","startsWith","endsWith","inner","slice","normalizedInner","undefined","getColumn","connectionId","column","datasourceType","query","response$","fetch","url","method","queries","datasource","uid","rawSql","resultData","nameField","dataTypeField","columnTypeField","ok","results","frames","dataFrame","dataTypeValue","columnTypeValue","columnInfo","normalizedType","getInvertedIndexColumns","getInvertedIndexes","columnNameField","indexTypeField","columnNames","indexTypes","indexedColumns","indexType","getDatabases","selectdbDS","getTablesService","getFieldsService","getColumnFromFieldService","getIndexesService"],"sourceRoot":""}